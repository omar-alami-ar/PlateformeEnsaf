@model PlateformeEnsaf.Models.ApplicationUser
@{
    ViewData["Title"] = "Profile";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@functions{
    public string TimeAgo(DateTime dateTime)
    {
        string result = string.Empty;
        var timeSpan = DateTime.Now.Subtract(dateTime);

        if (timeSpan <= TimeSpan.FromSeconds(60))
        {
            result = string.Format("Il y a {0} secondes", timeSpan.Seconds);
        }
        else if (timeSpan <= TimeSpan.FromMinutes(60))
        {
            result = timeSpan.Minutes > 1 ?
                String.Format("Il y a {0} minutes", timeSpan.Minutes) :
                "Il y a une minute";
        }
        else if (timeSpan <= TimeSpan.FromHours(24))
        {
            result = timeSpan.Hours > 1 ?
                String.Format("Il y a {0} heures", timeSpan.Hours) :
                "Il y a une heure";
        }
        else if (timeSpan <= TimeSpan.FromDays(30))
        {
            result = timeSpan.Days > 1 ?
                String.Format("Il y a {0} jours", timeSpan.Days) :
                "Hier";
        }
        else if (timeSpan <= TimeSpan.FromDays(365))
        {
            result = timeSpan.Days > 30 ?
                String.Format("Il y a {0} mois", timeSpan.Days / 30) :
                "Il y a un mois";
        }
        else
        {
            result = timeSpan.Days > 365 ?
                String.Format("Il y a {0} ans", timeSpan.Days / 365) :
                "Il y a un an";
        }

        return result;
    }
}
<link href="~/css/star-rating.css" rel="stylesheet" />

<style>
    .circular--landscape {
        display: inline-block;
        position: relative;
        width: 5rem;
        height: 5rem;
        overflow: hidden;
        border-radius: 50%;
    }

        .circular--landscape img {
            width: auto;
            height: 100%;
            margin-left: -50px;
        }

    .profile-img {
        border-radius: 20%;
        height: 200px;
        width: 200px;
        overflow: hidden;
        display: inline-block;
    }

        .profile-img img {
            width: 100%;
            height: auto;
            margin-left: -50px;
        }
</style>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/MaterialDesign-Webfont/5.3.45/css/materialdesignicons.css" integrity="sha256-NAxhqDvtY0l4xn+YVa6WjAcmd94NNfttjNsDmNatFVc=" crossorigin="anonymous" />
<link href="~/css/profile.css" rel="stylesheet" />
<div class="container">
    <div class="row mb-3">
        <div class="btn-group col-lg-1 col-sm-1">
            <button onClick="history.go(-1); return false;" type="submit" id="back-btn" style="color: #4e73df" class="d-flex align-items-center btn btn-sm btn-custom waves-effect waves-light"><i class="fa-solid fa-arrow-left-long mr-2" style="color: #4e73df"></i>Retour</button>
        </div>
    </div>
    <div class="row">
        <div class="col-xl-5">
            <div class="card border-left-primary">
                <div class="card-body">
                    <div class="d-flex align-items-start">
                        @*<div class="circular--landscape" style="background-image:url(data:image/\*;base64,@(Convert.ToBase64String(Model.ProfilePicture)))"></div>*@

                        @if (Model.ProfilePicture != null)
                        {
                            <img src="data:image/*;base64,@(Convert.ToBase64String(Model.ProfilePicture))" class="rounded-circle" style="width:112px; height:112px" alt="profile-image">
                        }
                        else
                        {

                            <img class=" rounded-circle" src="~/img/undraw_profile.svg" alt="" style="width:112px; height:112px">
                        }


                        <div class="w-100 ms-3 ml-3">
                            <h4 class="my-0 text-dark">@Model.FirstName @Model.LastName</h4>
                            <p class="text-muted"><span>@@</span>@Model.UserName</p>
                            @if (Model.Id != ViewBag.CurrentUserId)
                            {
                                if (ViewBag.checkFollow == null)
                                {
                                    <button id="follow" type="button" class="btn btn-primary btn-xs waves-effect mb-2 waves-light text-white ">Suivre</button>
                                }
                                else
                                {
                                    <button id="follow" type="button" class="btn btn-danger btn-xs waves-effect mb-2 waves-light text-white ">Ne plus suivre</button>
                                }
                                <a type="button" asp-action="Index" asp-controller="Chat" asp-route-id="@Model.Id" class="btn btn-success btn-xs waves-effect mb-2 waves-light text-white ">Message</a>
                            }
                        </div>
                    </div>

                    <div class="mt-3">
                        <input type="hidden" name="noteSum" id="noteSum" value="@if(ViewBag.NoteSum != null) { @ViewBag.NoteSum }" />
                        <input type="hidden" name="nbrVote" id="nbrVote" value="@if(ViewBag.NbrVotes != null) { @ViewBag.NbrVotes }" />
                        <input type="hidden" name="lastVote" id="lastVote" value="@if(ViewBag.lastVote != null) { @ViewBag.lastVote }" />

                        @*<h7>
            Nombre de Vote :<span id="NewNbrVotes">
                @if (ViewBag.NbrVotes != null && ViewBag.NbrVotes != 0)
                {@ViewBag.NbrVotes }
            else
            { <span>0</span>}
            </span>
        </h7>*@

                        
                    <div class="col row d-flex justify-content-between">

                        <div class="ml-4 text-center mb-3">
                            <i class="fa fa-star fa-fw" style="color:#FF912C"></i> <span id="NewNoteSum">
                                @if (ViewBag.NoteSum != null && ViewBag.NoteSum != 0)
                                {@((float)(Math.Round((double)(ViewBag.NoteSum / ViewBag.NbrVotes), 2))) }
                                else
                                { <span>0</span>}
                            </span>
                        </div>
                        @if (Model.Id != ViewBag.CurrentUserId)
                        {

                            <div class="no-gutters align-items-center">
                                <div class="col mr-2">

                                    <div class="h5 mb-0 font-weight-bold text-gray-800">
                                        <section class='rating-widget'>

                                            <!-- Rating Stars Box -->
                                            <div class='rating-stars text-start'>
                                                <ul id='stars'>
                                                    <li class='star' title='Poor' data-value='1'>
                                                        <i class='fa fa-star fa-fw'></i>
                                                    </li>
                                                    <li class='star' title='Fair' data-value='2'>
                                                        <i class='fa fa-star fa-fw'></i>
                                                    </li>
                                                    <li class='star' title='Good' data-value='3'>
                                                        <i class='fa fa-star fa-fw'></i>
                                                    </li>
                                                    <li class='star' title='Excellent' data-value='4'>
                                                        <i class='fa fa-star fa-fw'></i>
                                                    </li>
                                                    <li class='star' title='WOW!!!' data-value='5'>
                                                        <i class='fa fa-star fa-fw'></i>
                                                    </li>
                                                </ul>
                                            </div>

                                            <div hidden class='success-box'>
                                                <div class='clearfix'></div>
                                                <img alt='tick image' width='20' src='data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTkuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA0MjYuNjY3IDQyNi42NjciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDQyNi42NjcgNDI2LjY2NzsiIHhtbDpzcGFjZT0icHJlc2VydmUiIHdpZHRoPSI1MTJweCIgaGVpZ2h0PSI1MTJweCI+CjxwYXRoIHN0eWxlPSJmaWxsOiM2QUMyNTk7IiBkPSJNMjEzLjMzMywwQzk1LjUxOCwwLDAsOTUuNTE0LDAsMjEzLjMzM3M5NS41MTgsMjEzLjMzMywyMTMuMzMzLDIxMy4zMzMgIGMxMTcuODI4LDAsMjEzLjMzMy05NS41MTQsMjEzLjMzMy0yMTMuMzMzUzMzMS4xNTcsMCwyMTMuMzMzLDB6IE0xNzQuMTk5LDMyMi45MThsLTkzLjkzNS05My45MzFsMzEuMzA5LTMxLjMwOWw2Mi42MjYsNjIuNjIyICBsMTQwLjg5NC0xNDAuODk4bDMxLjMwOSwzMS4zMDlMMTc0LjE5OSwzMjIuOTE4eiIvPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K' />
                                                <div class='text-message'></div>
                                                <div class='clearfix'></div>
                                            </div>

                                        </section>
                                    </div>
                                </div>

                            </div>

                            }
                        </div>
                        
                            <h4 class="fw- mb-2 font-13 text-uppercase text-dark">A propos de moi:</h4>
                            <p class="text-muted font-13 mb-3">
                                @Model.Biographie
                            </p>
                            <input type="hidden" name="profileId" id="profileId" value="@Model.Id" />

                            <p class="text-muted mb-2 font-13 text-dark"><strong>Nom Complet :</strong> <span class="ms-2">@Model.FirstName @Model.LastName</span></p>

                            <p class="text-muted mb-2 font-13 text-dark"><strong>Etudes :</strong> <span class="ms-2">@Model.Niveau en @Model.Filiere.Nom</span></p>

                            <p class="text-muted mb-2 font-13 text-dark"><strong>Telephone :</strong> <span class="ms-2">@Model.PhoneNumber</span></p>

                            <p class="text-muted mb-2 font-13 text-dark"><strong>Email :</strong> <span class="ms-2">@Model.Email</span></p>

                            <p class="text-muted mb-1 font-13 text-dark"><strong>Adresse :</strong> <span class="ms-2">@Model.Adresse</span></p>
                        </div>

                    <p class="text-muted mb-1 font-13 text-dark"><strong>Réseaux sociaux :</strong></p>
                    <ul class="social-list list-inline mt-1 mb-0">
                        <li class="list-inline-item">
                            <a href="javascript: void(0);" class="social-list-item text-center border-primary text-primary"><i class="mdi mdi-facebook"></i></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="javascript: void(0);" class="social-list-item text-center border-danger text-danger"><i class="mdi mdi-google"></i></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="javascript: void(0);" class="social-list-item text-center border-info text-info"><i class="mdi mdi-twitter"></i></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="javascript: void(0);" class="social-list-item text-center border-secondary text-secondary"><i class="mdi mdi-github"></i></a>
                        </li>
                    </ul>
                    <div class="mt-3 row">
                        <div class="col-4 border-end border-light">
                            <h6 class="text-dark mt-1 mb-2 fw-bold">Annonces</h6>
                            <h4 class="mb-0 fw-bold">@Model.Annonces.Count</h4>
                        </div>
                        <div class="col-4 border-end border-light">
                            <h6 class="text-dark mt-1 mb-2 fw-bold">Abonnés</h6>
                            <h4 class="mb-0 fw-bold" id="nbrAbonnes">@Model.Followers.Count</h4>
                        </div>
                        <div class="col-4">
                            <h6 class="text-dark mt-1 mb-2 fw-bold">Abonnements</h6>
                            <h4 class="mb-0 fw-bold" id="nbrAbonnements">
                                @Model.Follows.Count
                            </h4>
                        </div>
                    </div>
                </div>
            </div> <!-- end card -->

       

                                    <!-- Rating Stars Box -->
                                    <!--<div class='rating-stars text-center'>
                                        <ul id='stars'>
                                            <li class='star' title='Poor' data-value='1'>
                                                <i class='fa fa-star fa-fw'></i>
                                            </li>
                                            <li class='star' title='Fair' data-value='2'>
                                                <i class='fa fa-star fa-fw'></i>
                                            </li>
                                            <li class='star' title='Good' data-value='3'>
                                                <i class='fa fa-star fa-fw'></i>
                                            </li>
                                            <li class='star' title='Excellent' data-value='4'>
                                                <i class='fa fa-star fa-fw'></i>
                                            </li>
                                            <li class='star' title='WOW!!!' data-value='5'>
                                                <i class='fa fa-star fa-fw'></i>
                                            </li>
                                        </ul>
                                    </div>

                                    <div class='success-box'>
                                        <div class='clearfix'></div>
                                        <img alt='tick image' width='20' src='data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTkuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA0MjYuNjY3IDQyNi42NjciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDQyNi42NjcgNDI2LjY2NzsiIHhtbDpzcGFjZT0icHJlc2VydmUiIHdpZHRoPSI1MTJweCIgaGVpZ2h0PSI1MTJweCI+CjxwYXRoIHN0eWxlPSJmaWxsOiM2QUMyNTk7IiBkPSJNMjEzLjMzMywwQzk1LjUxOCwwLDAsOTUuNTE0LDAsMjEzLjMzM3M5NS41MTgsMjEzLjMzMywyMTMuMzMzLDIxMy4zMzMgIGMxMTcuODI4LDAsMjEzLjMzMy05NS41MTQsMjEzLjMzMy0yMTMuMzMzUzMzMS4xNTcsMCwyMTMuMzMzLDB6IE0xNzQuMTk5LDMyMi45MThsLTkzLjkzNS05My45MzFsMzEuMzA5LTMxLjMwOWw2Mi42MjYsNjIuNjIyICBsMTQwLjg5NC0xNDAuODk4bDMxLjMwOSwzMS4zMDlMMTc0LjE5OSwzMjIuOTE4eiIvPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K' />
                                        <div class='text-message'></div>
                                        <div class='clearfix'></div>
                                    </div>

                                </section>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        }-->



            <!--<div class="card">
            <div class="card-body">
                <h4 class="header-title mb-3">Inbox</h4>

                <div class="inbox-widget" data-simplebar="init" style="max-height: 350px;">
                    <div class="simplebar-wrapper" style="margin: 0px;">
                        <div class="simplebar-height-auto-observer-wrapper"><div class="simplebar-height-auto-observer"></div></div><div class="simplebar-mask">
                            <div class="simplebar-offset" style="right: 0px; bottom: 0px;">
                                <div class="simplebar-content-wrapper" style="height: auto; overflow: hidden scroll;">
                                    <div class="simplebar-content" style="padding: 0px;">
                                        <div class="d-flex align-items-center pb-1" id="tooltips-container">
                                            <img src="https://bootdey.com/img/Content/avatar/avatar2.png" class="rounded-circle img-fluid avatar-md img-thumbnail bg-transparent" alt="">
                                            <div class="w-100 ms-3">
                                                <h5 class="mb-1">Tomaslau</h5>
                                                <p class="mb-0 font-13">I've finished it! See you so...</p>
                                            </div>
                                            <a href="javascript:(0);" class="btn btn-sm btn-soft-info font-13" data-bs-container="#tooltips-container" data-bs-toggle="tooltip" data-bs-placement="left" title="" data-bs-original-title="Reply"> <i class="mdi mdi-reply"></i> </a>
                                        </div>
                                        <div class="d-flex align-items-center py-1" id="tooltips-container1">
                                            <img src="https://bootdey.com/img/Content/avatar/avatar3.png" class="rounded-circle img-fluid avatar-md img-thumbnail bg-transparent" alt="">
                                            <div class="w-100 ms-3">
                                                <h5 class="mb-1">Stillnotdavid</h5>
                                                <p class="mb-0 font-13">This theme is awesome!</p>
                                            </div>
                                            <a href="javascript:(0);" class="btn btn-sm btn-soft-info font-13" data-bs-container="#tooltips-container1" data-bs-toggle="tooltip" data-bs-placement="left" title="" data-bs-original-title="Reply"> <i class="mdi mdi-reply"></i> </a>
                                        </div>
                                        <div class="d-flex align-items-center py-1" id="tooltips-container2">
                                            <img src="https://bootdey.com/img/Content/avatar/avatar4.png" class="rounded-circle img-fluid avatar-md img-thumbnail bg-transparent" alt="">
                                            <div class="w-100 ms-3">
                                                <h5 class="mb-1">Shahedk</h5>
                                                <p class="mb-0 font-13">Hey! there I'm available...</p>
                                            </div>
                                            <a href="javascript:(0);" class="btn btn-sm btn-soft-info font-13" data-bs-container="#tooltips-container2" data-bs-toggle="tooltip" data-bs-placement="left" title="" data-bs-original-title="Reply"> <i class="mdi mdi-reply"></i> </a>
                                        </div>
                                        <div class="d-flex align-items-center py-1" id="tooltips-container3">
                                            <img src="https://bootdey.com/img/Content/avatar/avatar5.png" class="rounded-circle img-fluid avatar-md img-thumbnail bg-transparent" alt="">
                                            <div class="w-100 ms-3">
                                                <h5 class="mb-1">Kurafire</h5>
                                                <p class="mb-0 font-13">Nice to meet you</p>
                                            </div>
                                            <a href="javascript:(0);" class="btn btn-sm btn-soft-info font-13" data-bs-container="#tooltips-container3" data-bs-toggle="tooltip" data-bs-placement="left" title="" data-bs-original-title="Reply"> <i class="mdi mdi-reply"></i> </a>
                                        </div>
                                        <div class="d-flex align-items-center py-1" id="tooltips-container4">
                                            <img src="https://bootdey.com/img/Content/avatar/avatar6.png" class="rounded-circle img-fluid avatar-md img-thumbnail bg-transparent" alt="">
                                            <div class="w-100 ms-3">
                                                <h5 class="mb-1">Adhamdannaway</h5>
                                                <p class="mb-0 font-13">This theme is awesome!</p>
                                            </div>
                                            <a href="javascript:(0);" class="btn btn-sm btn-soft-info font-13" data-bs-container="#tooltips-container4" data-bs-toggle="tooltip" data-bs-placement="left" title="" data-bs-original-title="Reply"> <i class="mdi mdi-reply"></i> </a>
                                        </div>
                                        <div class="d-flex align-items-center py-1" id="tooltips-container5">
                                            <img src="https://bootdey.com/img/Content/avatar/avatar7.png" class="rounded-circle img-fluid avatar-md img-thumbnail bg-transparent" alt="">
                                            <div class="w-100 ms-3">
                                                <h5 class="mb-1">Tomaslau</h5>
                                                <p class="mb-0 font-13">I've finished it! See you so...</p>
                                            </div>
                                            <a href="javascript:(0);" class="btn btn-sm btn-soft-info font-13" data-bs-container="#tooltips-container5" data-bs-toggle="tooltip" data-bs-placement="left" title="" data-bs-original-title="Reply"> <i class="mdi mdi-reply"></i> </a>
                                        </div>
                                        <div class="d-flex align-items-center py-1" id="tooltips-container6">
                                            <img src="https://bootdey.com/img/Content/avatar/avatar8.png" class="rounded-circle img-fluid avatar-md img-thumbnail bg-transparent" alt="">
                                            <div class="w-100 ms-3">
                                                <h5 class="mb-1">Shahedk</h5>
                                                <p class="mb-0 font-13">Hey! there I'm available...</p>
                                            </div>
                                            <a href="javascript:(0);" class="btn btn-sm btn-soft-info font-13" data-bs-container="#tooltips-container6" data-bs-toggle="tooltip" data-bs-placement="left" title="" data-bs-original-title="Reply"> <i class="mdi mdi-reply"></i> </a>
                                        </div>
                                        <div class="d-flex align-items-center pt-1" id="tooltips-container7">
                                            <img src="https://bootdey.com/img/Content/avatar/avatar5.png" class="rounded-circle img-fluid avatar-md img-thumbnail bg-transparent" alt="">
                                            <div class="w-100 ms-3">
                                                <h5 class="mb-1">Stillnotdavid</h5>
                                                <p class="mb-0 font-13">This theme is awesome!</p>
                                            </div>
                                            <a href="javascript:(0);" class="btn btn-sm btn-soft-info font-13" data-bs-container="#tooltips-container7" data-bs-toggle="tooltip" data-bs-placement="left" title="" data-bs-original-title="Reply"> <i class="mdi mdi-reply"></i> </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div><div class="simplebar-placeholder" style="width: auto; height: 532px;"></div>
                    </div><div class="simplebar-track simplebar-horizontal" style="visibility: hidden;"><div class="simplebar-scrollbar" style="width: 0px; display: none;"></div></div><div class="simplebar-track simplebar-vertical" style="visibility: visible;"><div class="simplebar-scrollbar" style="height: 230px; transform: translate3d(0px, 0px, 0px); display: block;"></div></div>
                </div>-->
            <!-- end inbox-widget -->
            <!--</div>
            </div>-->
            <!-- end card-->
            <div class="card shadow mb-4">
                <!-- Card Header - Dropdown -->
                <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                    <h6 class="m-0 font-weight-bold text-primary">Membres qui pourraient vous interesser <i class="mdi mdi-account-multiple ms-1"></i></h6>
                    @*<div class="dropdown no-arrow">
                        <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink"
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                        </a>
                        <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in"
                             aria-labelledby="dropdownMenuLink">
                            <div class="dropdown-header">Dropdown Header:</div>
                            <a class="dropdown-item" href="#">Action</a>
                            <a class="dropdown-item" href="#">Another action</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="#">Something else here</a>
                        </div>
                    </div>*@
                </div>
                <!-- Card Body -->
                <div class="card-body">
                    <!-- Item 1-->
                    @foreach (var follow in Model.Follows)
                    {
                        <div class="d-flex align-items-center justify-content-between mb-4">
                            <div class="d-flex align-items-center flex-shrink-0 me-3">
                                @if (follow.FollowedUser.ProfilePicture != null)
                                {
                                    <img class=" rounded-circle" src="data:image/*;base64,@(Convert.ToBase64String(follow.FollowedUser.ProfilePicture))" alt="" style="height:3rem; width:3rem; margin-right:1rem">
                                }
                                else
                                {

                                    <img class=" rounded-circle" src="~/img/undraw_profile.svg" alt="" style="height:3rem; width:3rem; margin-right:1rem">
                                }
                                <div class="d-flex flex-column fw-bold">
                                    <a class="text-dark line-height-normal mb-1" asp-controller="Account" asp-action="Profile" asp-route-id="@follow.FollowedUser.Id">@follow.FollowedUser.FirstName @follow.FollowedUser.LastName</a>
                                    <div class="small text-muted line-height-normal">@follow.FollowedUser.Email</div>
                                </div>
                            </div>
                            <div class="dropdown no-arrow">
                                <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink"
                                   data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                                </a>
                                <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in"
                                     aria-labelledby="dropdownMenuLink">
                                    <div class="dropdown-header">Dropdown Header:</div>
                                    <a class="dropdown-item" href="#">Action</a>
                                    <a class="dropdown-item" href="#">Another action</a>
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item" href="#">Something else here</a>
                                </div>
                            </div>
                        </div>
                    }

                </div>
            </div>


            @*<div class="card">
                    <div class="card-body">

                        <h4 class="header-title mb-3">Upcoming Reminders <i class="mdi mdi-adjust ms-1"></i></h4>

                        <div class="list-group">
                            <a href="#" class="my-1">
                                <div class="d-flex align-items-start" id="tooltips-container">
                                    <div class="">
                                        <i class="mdi mdi-circle h3 text-primary"></i>
                                    </div>
                                    <div class="w-100 ms-2">
                                        <h5 class="mb-1 mt-0">New Admin Layout Discuss</h5>
                                        <ul class="list-inline text-muted font-12">
                                            <li class="list-inline-item"><i class="mdi mdi-calendar-blank-outline me-1"></i>10 May 2021</li>
                                            <li class="list-inline-item"> - </li>
                                            <li class="list-inline-item"><i class="mdi mdi-clock-time-eight-outline me-1"></i>09:00am <span class="px-1">To</span> 10:30am</li>
                                        </ul>
                                    </div>
                                </div>
                            </a>
                            <a href="#" class="my-1">
                                <div class="d-flex align-items-start" id="tooltips-container">
                                    <div class="">
                                        <i class="mdi mdi-circle h3 text-pink"></i>
                                    </div>
                                    <div class="w-100 ms-2">
                                        <h5 class="mb-1 mt-0">Landing Pages Planning</h5>
                                        <ul class="list-inline text-muted font-12">
                                            <li class="list-inline-item"><i class="mdi mdi-calendar-blank-outline me-1"></i>10 May 2021</li>
                                            <li class="list-inline-item"> - </li>
                                            <li class="list-inline-item"><i class="mdi mdi-clock-time-eight-outline me-1"></i>02:00pm <span class="px-1">To</span> 4:00pm</li>
                                        </ul>
                                    </div>
                                </div>
                            </a>
                            <a href="#" class="my-1">
                                <div class="d-flex align-items-start" id="tooltips-container">
                                    <div class="">
                                        <i class="mdi mdi-circle h3 text-success"></i>
                                    </div>
                                    <div class="w-100 ms-2">
                                        <h5 class="mb-1 mt-0">Meet Our Clients</h5>
                                        <ul class="list-inline text-muted font-12">
                                            <li class="list-inline-item"><i class="mdi mdi-calendar-blank-outline me-1"></i>11 May 2021</li>
                                            <li class="list-inline-item"> - </li>
                                            <li class="list-inline-item"><i class="mdi mdi-clock-time-eight-outline me-1"></i>08:00am <span class="px-1">To</span> 11:20am</li>
                                        </ul>
                                    </div>
                                </div>
                            </a>
                            <a href="#" class="my-1">
                                <div class="d-flex align-items-start" id="tooltips-container">
                                    <div class="">
                                        <i class="mdi mdi-circle h3 text-warning"></i>
                                    </div>
                                    <div class="w-100 ms-2">
                                        <h5 class="mb-1 mt-0">Project Discussion</h5>
                                        <ul class="list-inline text-muted font-12">
                                            <li class="list-inline-item"><i class="mdi mdi-calendar-blank-outline me-1"></i>11 May 2021</li>
                                            <li class="list-inline-item"> - </li>
                                            <li class="list-inline-item"><i class="mdi mdi-clock-time-eight-outline me-1"></i>12:00am <span class="px-1">To</span> 03:00am</li>
                                        </ul>
                                    </div>
                                </div>
                            </a>
                            <a href="#" class="my-1">
                                <div class="d-flex align-items-start" id="tooltips-container">
                                    <div class="">
                                        <i class="mdi mdi-circle h3 text-dark"></i>
                                    </div>
                                    <div class="w-100 ms-2">
                                        <h5 class="mb-1 mt-0">Businees Meeting</h5>
                                        <ul class="list-inline text-muted font-12">
                                            <li class="list-inline-item"><i class="mdi mdi-calendar-blank-outline me-1"></i>12 May 2021</li>
                                            <li class="list-inline-item"> - </li>
                                            <li class="list-inline-item"><i class="mdi mdi-clock-time-eight-outline me-1"></i>08:30am <span class="px-1">To</span> 10:00am</li>
                                        </ul>
                                    </div>
                                </div>
                            </a>

                        </div>
                    </div>
                </div>*@
        </div> <!-- end col-->

        <div class="col-xl-7">
            <div>
                @foreach (var annonce in ViewBag.userAnnonces)
                {
                    <div class="card shadow gedf-card mb-3">
                        <div class="card-header">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="mr-2">
                                        @if (annonce.User.ProfilePicture != null)
                                        {
                                            <img class="rounded-circle" src="data:image/*;base64,@(Convert.ToBase64String(annonce.User.ProfilePicture))" alt="" width="45" height="45">
                                        }
                                        else
                                        {
                                            <img class="rounded-circle" src="~/img/undraw_profile.svg" alt="" width="45">
                                        }

                                    </div><div class="ml-2"><a asp-controller="Account" asp-action="Profile" asp-route-id="@annonce.User.Id" class="h5 m-0 text-muted">@annonce.User.FirstName @annonce.User.LastName</a><div class="h7 text-muted"><span>@@</span>@annonce.User.UserName</div></div>
                                </div>
                                @*<div><div class="dropdown"> <button class="btn btn-link dropdown-toggle" type="button" id="gedf-drop1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="fa fa-ellipsis-h"></i> </button><div class="dropdown-menu dropdown-menu-right" aria-labelledby="gedf-drop1"><div class="h6 dropdown-header">Configuration</div> <a class="dropdown-item" href="#">Save</a> <a class="dropdown-item" href="#">Hide</a> <a class="dropdown-item" href="#">Report</a></div></div></div>*@
                                @*<div>
                                    @{
                                        
                                        var save = User.Result.Enregistrements.Where(a => a.Annonce == annonce).FirstOrDefault();
                                        @if (save != null)
                                        {
                                            <i class="fas fa-bookmark saved bookmark" id="@annonce.Id" style="cursor: pointer; color:#4e73df"></i>
                                        }
                                        else
                                        {
                                            <i class="far fa-bookmark unsaved bookmark" id="@annonce.Id" style="cursor:pointer"></i>
                                        }
                                    }
                                </div>*@
                            </div>
                        </div>
                        <div class="card-body">

                            <div class="text-muted h7 d-flex align-items-center justify-content-between mb-2">

                                <h5 class="card-link">@annonce.Categorie.ToString()</h5><h6>@TimeAgo(annonce.DatePublication)</h6>
                            </div>

                            <a class="card-link" asp-action="DetailsOff" asp-controller="Annonce" asp-route-id="@annonce.Id">
                                <h5 class="card-title">
                                    @annonce.Titre
                                </h5>
                            </a><p class="card-text">
                                @annonce.Description
                            </p>
                            @*@if (annonce.Images.Count != 0)
                        {
                            @if (annonce.Images.Count == 1)
                            {
                                @foreach (var image in annonce.Images) {
                                <img src="data:image/*;base64,@(Convert.ToBase64String(image.Contenu))" class="img-responsive" width="200">
                                    }
                                }
                            else
                            {
                                <div class="d-flex">
                                    @foreach (var image in annonce.Images)
                                    {
                                        <img src="data:image/*;base64,@(Convert.ToBase64String(image.Contenu))" class="img-responsive mr-2" width="200">
                                    }
                    </div>
                            }
                        }*@
                            <div class="mt-2">
                                @foreach (var domaine in annonce.Annonce_Domaines)
                                {
                                    <span class="badge badge-primary">@domaine.Domaine.Nom</span>
                                }

                            </div>
                        </div>
                        <div class="card-footer">
                            @*@{var rating = Model.Rated_Annonces.Where(a => a.Annonce == annonce).FirstOrDefault();
                                if (rating != null)
                                {
                                    if (rating.Type == "upvote")
                                    {
                                        <a style="cursor:pointer" class="card-link up upvoted" id="upvote"><i class="fa-solid fa-circle-up"></i> <span id="@annonce.Id">Upvoted</span></a>
                                        <a style="cursor:pointer" class="card-link down" id="downvote"><i class="fa-solid fa-circle-down"></i> <span id="@annonce.Id">Downvote</span></a>
                                    }
                                    else
                                    {
                                        <a style="cursor:pointer" class="card-link up" id="upvote"><i class="fa-solid fa-circle-up"></i> <span id="@annonce.Id">Upvote</span></a>
                                        <a style="cursor:pointer" class="card-link down downvoted" id="downvote"><i class="fa-solid fa-circle-down"></i> <span id="@annonce.Id">Downvoted</span></a>
                                    }
                                }
                                else
                                {
                                    <a style="cursor:pointer" class="card-link up" id="upvote"><i class="fa-solid fa-circle-up"></i> <span id="@annonce.Id">Upvote</span></a>
                                    <a style="cursor:pointer" class="card-link down" id="downvote"><i class="fa-solid fa-circle-down"></i> <span id="@annonce.Id">Downvote</span></a>
                                }

                            }*@



                            <a href="" id="" class="card-link comment-btn"><i class="fa fa-comment"></i> Commenter</a>
                            <a href="#" class="card-link"><i class="fa fa-mail-forward"></i> Partager</a>
                            <br />
                            <div class="comment">

                                <textarea rows="3" id="commentContent" placeholder="Votre commentaire" style="height: 68px;" class="form-control mt-3"></textarea>
                                <div class="text-right">
                                    <button type="submit" id="@annonce.Id" class="sendComment btn btn-primary mt-1">Envoyer</button>
                                </div>

                            </div>
                        </div>
                    </div>
                }

            </div>

        </div> <!-- end col -->
    </div>
    <!-- end row-->

</div>


<script>

    var starl = $('#stars li').parent().children('li.star');
    console.log($('#lastVote').val());
    if ($('#lastVote').val() != null || $('#lastVote').val() != 0) {
        
        for (i = 0; i < $('#lastVote').val(); i++) {
            $(starl[i]).addClass('selected');
        }
    }
</script>

<script type="text/javascript">$('#follow').on('click', function () {
        var targetUserId = $('#profileId').val();
        /*var targetUserId = "hhhhhhhh";*/
        //console.log(targetUserId);

        $.ajax({
            type: "POST",
            url: "/Account/FollowUnfollow",
            data: { id: targetUserId },
            success: function (result) {
                //console.log(null);
                if (result == "followed") {
                    var followers = parseInt($('#nbrAbonnes').text());
                    var newNbr = followers + 1;
                    //console.log(followers);
                    $('#follow').removeClass('btn-primary');
                    $('#follow').addClass('btn-danger');
                    $('#follow').text('Ne plus suivre');
                    $('#nbrAbonnes').text(newNbr);

                } else {
                    var followers = parseInt($('#nbrAbonnes').text());
                    var newNbr = followers - 1;
                    $('#follow').removeClass('btn-danger');
                    $('#follow').addClass('btn-primary');
                    $('#follow').text('Suivre');
                    $('#nbrAbonnes').text(newNbr);

                }


            },
            error: function (req, status, error) {
                //console.log(result);
            }
        });
    });</script>

<script>
    $(document).ready(function () {
        $(".comment").hide();
        $(".comment-btn").on('click', function (event) {
            var btn = $(this);
            var comment_section = btn.siblings(".comment");
            var comment_box = comment_section.children("textarea");
            comment_section.slideToggle(500);
            event.preventDefault();
            //console.log(btn);
            //console.log(comment_section);
            //console.log(comment_box);

            $(".sendComment").on('click', function () {
                $.ajax({
                    type: "POST",
                    url: '/Annonce/Commenter',
                    data: {
                        id: $(this).attr("id"),
                        content: comment_box.val()
                    },
                    /* Response is the data returned from controller method */
                    success: function () {

                        /* console.log(comment_box);*/
                    }
                });

            });

        });



        $(".bookmark").on('click', function () {
            var save = $(this);
            $.ajax({
                type: "POST",
                url: '/Home/Save',
                data: {
                    id: $(this).attr("id")
                },
                /* Response is the data returned from controller method */
                success: function () {
                    if (save.hasClass('unsaved')) {
                        save.removeClass('far');
                        save.removeClass('unsaved');
                        save.addClass('fas');
                        save.addClass('saved');
                        save.css('color', '#4e73df');
                    } else {
                        save.removeClass('fas');
                        save.removeClass('saved');
                        save.addClass('far');
                        save.addClass('unsaved');
                        save.css('color', '');
                    }
                }
            });

        });
        $(".up").on('click', function () {
            var upvote = $(this);
            var downvote = $(this).next();
            $.ajax({
                type: "POST",
                url: '/Annonce/Upvote',
                data: {
                    id: $(this).find('span').attr("id")
                },
                /* Response is the data returned from controller method */
                success: function (response) {
                    if (response == "upvoted") {
                        //TODO : Use these values to update your page.
                        upvote.addClass("upvoted");
                        //$(this).find('i').css("color", "#FF4500");
                        upvote.find('span').text("Upvoted");
                        //$(this).find('span').css("color", "#FF4500");
                        if (downvote.hasClass("downvoted")) {
                            downvote.removeClass("downvoted");
                            downvote.find('span').text("Downvote");
                        }

                        return false;
                    }
                    else if (response == "cancelledUpvote") {
                        //console.log(response);
                        upvote.removeClass("upvoted");
                        upvote.find('span').text("Upvote");
                        return false;
                    }
                }
            });
        });

        $(".down").on('click', function () {
            var downvote = $(this);
            var upvote = $(this).prev();
            $.ajax({
                type: "POST",
                url: '/Annonce/Downvote',
                data: {
                    id: $(this).find('span').attr("id")
                },
                /* Response is the data returned from controller method */
                success: function (response) {
                    if (response == "downvoted") {
                        //TODO : Use these values to update your page.
                        downvote.addClass("downvoted");
                        //$(this).find('i').css("color", "#FF4500");
                        downvote.find('span').text("Downvoted");
                        //$(this).find('span').css("color", "#FF4500");
                        if (upvote.hasClass("upvoted")) {
                            upvote.removeClass("upvoted");
                            upvote.find('span').text("Upvote");
                        }

                        return false;
                    }
                    else if (response == "cancelledDownvote") {
                        // console.log(response);
                        downvote.removeClass("downvoted");
                        downvote.find('span').text("Downvote");
                        return false;
                    }
                }
            });
        });
        /* 1. Visualizing things on Hover - See next part for action on click */
        $('#stars li').on('mouseover', function () {
            var onStar = parseInt($(this).data('value'), 10); // The star currently mouse on
            
            // Now highlight all the stars that's not after the current hovered star
            $(this).parent().children('li.star').each(function (e) {
                if (e < onStar) {
                    $(this).addClass('hover');
                }
                else {
                    $(this).removeClass('hover');
                    
                }
            });

        }).on('mouseout', function () {
            $(this).parent().children('li.star').each(function (e) {
                $(this).removeClass('hover');
            });
        });


        /* 2. Action to perform on click */
        $('#stars li').on('click', function () {
            var onStar = parseInt($(this).data('value'), 10); // The star currently selected
            var targetUserId = $('#profileId').val();
            $.ajax({
                type: "POST",
                url: "/Account/Vote",
                data: { id: targetUserId, stars: onStar },
                success: function (result) {
                    if (result == "update") {

                        var newNote = (parseFloat(document.getElementById("noteSum").value) - parseFloat(document.getElementById("lastVote").value) + onStar) / parseFloat(document.getElementById("nbrVote").value);


                        newNote = Math.round(newNote * 100) / 100;

                        $("#noteSum").val($("#noteSum").val() - $("#lastVote").val() + onStar);
                        $('#lastVote').val(onStar);
                        $("#NewNoteSum").text(newNote);

                        //console.log($("#noteSum").val());
                        //console.log($('#lastVote').val());
                        //console.log($('#nbrVote').val());

                    } else {

                        var newnbrVotes = parseFloat(document.getElementById("nbrVote").value) + 1;
                        $("#NewNbrVotes").text(newnbrVotes);
                        $("#nbrVote").val(newnbrVotes);

                        var newNote = (parseFloat(document.getElementById("noteSum").value) + onStar) / (parseFloat(document.getElementById("nbrVote").value));
                        newNote = Math.round(newNote * 100) / 100;
                        $("#NewNoteSum").text(newNote);

                        $("#nbrVote").val(newnbrVotes);
                        $("#noteSum").val(parseFloat(document.getElementById("noteSum").value) + onStar);
                        $('#lastVote').val(onStar);


                        //console.log($("#noteSum").val());
                        //console.log($('#lastVote').val());
                        //console.log($('#nbrVote').val());
                       
                        
                        

                    }

                }
            });

                    var stars = $(this).parent().children('li.star');

                    for (i = 0; i < stars.length; i++) {
                        $(stars[i]).removeClass('selected');
                    }

                    for (i = 0; i < onStar; i++) {
                        $(stars[i]).addClass('selected');
                    }

                    // JUST RESPONSE (Not needed)
                    var ratingValue = parseInt($('#stars li.selected').last().data('value'), 10);
                    var msg = "";
                    if (ratingValue > 1) {
                        msg = "Thanks! You rated this " + ratingValue + " stars.";
                    }
                    else {
                        msg = "You rated this " + ratingValue + " stars.";
                    }
                    responseMessage(msg);
                
            
        });
    });
    function responseMessage(msg) {
        $('.success-box').fadeIn(200);
        $('.success-box div.text-message').html("<h5>" + msg + "</h5>");

    }
</script>

